<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocab Quiz - Complete Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap');

        :root {
            --bg-color: #E6E9EF;
            --ultramarine: #0033aa;
            --text-color: #2D3436;
            --shadow-light: #ffffff;
            --shadow-dark: #b8bfc9;
            --star-color: #f1c40f;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color);
            font-family: 'Noto Sans JP', sans-serif;
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .app-container {
            width: 100%;
            max-width: 500px;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        /* Top Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 0 5px;
        }

        /* Program Selector (Neumorphism Dropdown) */
        .program-select {
            background: var(--bg-color);
            border: none;
            font-size: 0.8rem;
            color: var(--ultramarine);
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            padding: 8px 30px 8px 15px;
            border-radius: 20px;
            box-shadow: 4px 4px 10px var(--shadow-dark),
                        -4px -4px 10px var(--shadow-light);
            outline: none;
            cursor: pointer;
            font-family: inherit;
            appearance: none;
            -webkit-appearance: none;
            /* Dropdown Arrow SVG */
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%230033aa%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 12px top 50%;
            background-size: 10px auto;
            transition: all 0.3s;
        }

        .program-select:focus, .program-select:active {
            box-shadow: inset 3px 3px 6px var(--shadow-dark),
                        inset -3px -3px 6px var(--shadow-light);
        }

        /* Filter Toggle */
        .filter-btn {
            background: var(--bg-color);
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-color);
            box-shadow: 4px 4px 10px var(--shadow-dark),
                        -4px -4px 10px var(--shadow-light);
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active {
            color: var(--ultramarine);
            box-shadow: inset 3px 3px 6px var(--shadow-dark),
                        inset -3px -3px 6px var(--shadow-light);
        }

        /* 3D Card Container */
        .card-container {
            perspective: 1000px;
            width: 100%;
            height: 380px;
            margin: 0 auto;
            position: relative;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            border-radius: 40px;
            background: var(--bg-color);
            box-shadow: 18px 18px 40px var(--shadow-dark),
                        -18px -18px 40px var(--shadow-light);
            cursor: pointer;
        }

        .card-face.back {
            transform: rotateY(180deg);
            background: linear-gradient(145deg, #eff2f7, var(--bg-color));
        }

        /* Star Icon on Card */
        .star-toggle {
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 1.8rem;
            color: #ccc;
            cursor: pointer;
            z-index: 100;
            transition: transform 0.2s, color 0.2s;
            padding: 15px;
            pointer-events: auto;
        }

        .star-toggle:active {
            transform: scale(1.3);
        }

        .star-toggle.is-starred {
            color: var(--star-color);
            text-shadow: 0 0 10px rgba(241, 196, 15, 0.4);
        }

        .category-label {
            font-size: 0.7rem;
            color: var(--ultramarine);
            font-weight: 700;
            margin-bottom: 20px;
            letter-spacing: 1px;
            opacity: 0.5;
            pointer-events: none;
        }

        .word-text {
            font-size: 1.7rem;
            font-weight: 700;
            line-height: 1.4;
            pointer-events: none;
        }

        .back .word-text {
            color: var(--ultramarine);
        }

        /* Hidden Slider Menu */
        .slider-overlay {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            width: 85%;
            padding: 30px 20px;
            background: var(--bg-color);
            border-radius: 30px;
            box-shadow: 10px 10px 30px var(--shadow-dark),
                        -10px -10px 30px var(--shadow-light);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 200;
        }

        .slider-overlay.visible {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        .custom-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: var(--bg-color);
            box-shadow: inset 3px 3px 6px var(--shadow-dark),
                        inset -3px -3px 6px var(--shadow-light);
            outline: none;
            cursor: pointer;
        }

        .custom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--ultramarine);
            cursor: pointer;
            border: 3px solid var(--bg-color);
            box-shadow: 3px 3px 8px var(--shadow-dark);
        }

        /* Footer Controls */
        .controls {
            margin-top: 40px;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-btn {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            border: none;
            background: var(--bg-color);
            box-shadow: 6px 6px 15px var(--shadow-dark),
                        -6px -6px 15px var(--shadow-light);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--ultramarine);
            font-size: 1.1rem;
            transition: 0.2s;
        }

        .nav-btn:active {
            box-shadow: inset 4px 4px 10px var(--shadow-dark),
                        inset -4px -4px 10px var(--shadow-light);
            transform: scale(0.96);
        }

        .progress-info {
            background: var(--ultramarine);
            color: white;
            padding: 10px 24px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 700;
            box-shadow: 0 8px 16px rgba(0, 51, 170, 0.2);
            min-width: 110px;
            cursor: pointer;
        }

        /* Slide animations */
        .slide-in-right { animation: slideInRight 0.4s ease-out; }
        .slide-in-left { animation: slideInLeft 0.4s ease-out; }

        @keyframes slideInRight { from { transform: translateX(30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideInLeft { from { transform: translateX(-30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <select id="program-select" class="program-select">
            <option value="Program 8" selected>Program 8</option>
            <option value="Program 7">Program 7</option>
            <option value="Program 6">Program 6</option>
            <option value="All">All Programs</option>
        </select>
        <button class="filter-btn" id="filter-btn">すべて</button>
    </div>
    
    <div class="card-container">
        <div class="card" id="card">
            <!-- 表面 -->
            <div class="card-face front" id="card-front">
                <div class="star-toggle" id="star-btn">★</div>
                <div class="category-label">意味</div>
                <div class="word-text" id="q-text">...</div>
            </div>
            <!-- 裏面 -->
            <div class="card-face back" id="card-back">
                <div class="category-label">English</div>
                <div class="word-text" id="a-text">...</div>
            </div>
        </div>
    </div>

    <!-- Hidden Slider Panel -->
    <div class="slider-overlay" id="slider-panel">
        <input type="range" id="progress-slider" class="custom-slider" min="1" max="1" value="1">
    </div>

    <div class="controls">
        <button class="nav-btn" id="prev-btn">◀</button>
        <div class="progress-info" id="progress-btn">1 / 1</div>
        <button class="nav-btn" id="next-btn">▶</button>
    </div>
</div>

<script>
    const databases = {
        "Program 6": [
            {q: "ハイテクの、高度先端技術", a: "high-tech"},
            {q: "カフェ", a: "cafe"},
            {q: "もっと", a: "more"},
            {q: "〜よりも", a: "than"},
            {q: "ドイツ", a: "Germany"},
            {q: "山", a: "Mt."},
            {q: "パフェ", a: "parfait"},
            {q: "最も", a: "most"},
            {q: "ロンドン（イギリスの首都）", a: "London"},
            {q: "役に立つ", a: "useful"},
            {q: "流行の、おしゃれな", a: "stylish"},
            {q: "センチメートル", a: "centimeter(s)"},
            {q: "ハス", a: "lotus"},
            {q: "葉", a: "leaf"},
            {q: "葉(leaf)の複数形", a: "leaves"},
            {q: "ぬれた", a: "wet"},
            {q: "雨だれ、雨つぶ", a: "raindrop(s)"},
            {q: "ふた", a: "lid"},
            {q: "くっつく", a: "stick"},
            {q: "別の、もうひとつの", a: "another"},
            {q: "〜にくっつく", a: "stick to ~"},
            {q: "ペット", a: "pet"},
            {q: "氷の(張った)", a: "icy"},
            {q: "〜なしで", a: "without"},
            {q: "すべる、すべってころぶ", a: "slip"},
            {q: "(動物の)足", a: "paw"},
            {q: "溝", a: "groove"},
            {q: "発明", a: "invention"},
            {q: "(船の)甲板、デッキ", a: "deck"},
            {q: "航海する", a: "sail"},
            {q: "生き延びる", a: "survive"},
            {q: "発展させる、開発する", a: "develop"},
            {q: "すべり止めのある", a: "non-slip"},
            {q: "ひらめき、インスピレーション", a: "inspiration"},
            {q: "ハチ、ミツバチ", a: "bee"},
            {q: "アメリカの25セント硬貨", a: "quarter"},
            {q: "硬貨", a: "coin"},
            {q: "紙ばさみ、ペーパークリップ", a: "paper clip"},
            {q: "できる、能力がある", a: "able"},
            {q: "可能性、潜在能力", a: "potential"},
            {q: "農業", a: "agriculture"},
            {q: "花粉", a: "pollen"},
            {q: "捜索、探索", a: "search"},
            {q: "狭い", a: "narrow"},
            {q: "空間、場所", a: "space"},
            {q: "生きている", a: "living"},
            {q: "植物", a: "plant"},
            {q: "生物（植物は含まない）", a: "creature"},
            {q: "〜することができる", a: "be able to"},
            {q: "エネルギー", a: "energy"},
            {q: "冷蔵庫(refrigerator)", a: "fridge"},
            {q: "より少ない(littleの比較級)", a: "less"},
            {q: "電気", a: "electricity"},
            {q: "続ける、続く", a: "continue"},
            {q: "努力", a: "effort"},
            {q: "オリバー（男子の名）", a: "Oliver"},
            {q: "エアコン", a: "air conditioner"},
            {q: "サーキュレーター", a: "air circulator"},
            {q: "カーテン", a: "curtain"},
            {q: "環境に配慮した、環境にやさしい", a: "eco-friendly"},
            {q: "より良い(goodの比較級)", a: "better"}
        ],
        "Program 7": [
            {q: "どこかへ（で）", a: "somewhere"},
            {q: "ハロウィーン（10月31日）", a: "Halloween"},
            {q: "花（おもに果樹の）", a: "blossom"},
            {q: "入場券、切符（きっぷ）", a: "ticket"},
            {q: "ペンギン", a: "penguin"},
            {q: "ラッコ", a: "sea otter"},
            {q: "とてもかわいい", a: "adorable"},
            {q: "情報", a: "information"},
            {q: "貝類", a: "shellfish"},
            {q: "ほお", a: "cheek(s)"},
            {q: "毛皮", a: "fur"},
            {q: "手のひら", a: "palm(s)"},
            {q: "1日に〜回", a: "~ times a day"},
            {q: "〜のいたるところに", a: "all over ~"},
            {q: "〜するために", a: "in order to ~"},
            {q: "〜を温める", a: "warm up ~"},
            {q: "同意する、賛成する", a: "agree"},
            {q: "頭の良い、かしこい", a: "smart"},
            {q: "ほ乳類", a: "mammal"},
            {q: "息をする、呼吸する", a: "breathe"},
            {q: "半分", a: "half"},
            {q: "脳", a: "brain"},
            {q: "目が覚めて", a: "awake"},
            {q: "おどろくべき、意外な", a: "surprising"},
            {q: "非常に、まったく", a: "quite"},
            {q: "わからない", a: "have no idea"},
            {q: "トビウオ", a: "flying fish"},
            {q: "〜だけれども", a: "though"},
            {q: "敵", a: "enemy (enemies)"},
            {q: "だし", a: "stock"},
            {q: "油であげる、フライにする", a: "fry (fried)"},
            {q: "いつも（必ずしも）〜とは限らない", a: "not always ~"},
            {q: "愛らしい、美しい", a: "lovely"},
            {q: "夜間", a: "nighttime"},
            {q: "昼間", a: "daytime"},
            {q: "ヒマワリ", a: "sunflower"},
            {q: "種、種子", a: "seed"},
            {q: "mouse(ネズミ)の複数形", a: "mice"},
            {q: "ハムスター", a: "hamster"},
            {q: "草", a: "grass"},
            {q: "ポケット", a: "pocket"},
            {q: "tooth(歯)の複数形", a: "teeth"},
            {q: "tellの過去形（過去分詞形も同じ）", a: "told"}
        ],
        "Program 8": [
            {q: "長く続く、永続的な", a: "lasting"},
            {q: "take(とる)の過去分詞形", a: "taken"},
            {q: "Eメール、電子メール", a: "email"},
            {q: "see(見る)の過去分詞形", a: "seen"},
            {q: "台所、キッチン", a: "kitchen"},
            {q: "sellの過去形/過去分詞形", a: "sold"},
            {q: "文房具", a: "stationery"},
            {q: "店", a: "store"},
            {q: "線", a: "line"},
            {q: "観光客、旅行者", a: "tourist"},
            {q: "buildの過去形/過去分詞形", a: "built"},
            {q: "write(書く)の過去分詞形", a: "written"},
            {q: "sing(歌う)の過去分詞形", a: "sung"},
            {q: "（絵を絵具などで）描く", a: "paint"},
            {q: "know(知る)の過去分詞形", a: "known"},
            {q: "満たす", a: "fill"},
            {q: "木材", a: "wood"},
            {q: "バター", a: "butter"},
            {q: "（否定文で）〜もまた…ない", a: "neither"},
            {q: "（返事で）まったくそのとおり", a: "absolutely"},
            {q: "breakの過去分詞形", a: "broken"},
            {q: "広島平和記念公園", a: "the Hiroshima Peace Memorial Park"},
            {q: "せっけん", a: "soap"},
            {q: "粘土", a: "clay"},
            {q: "再利用（リサイクル）された", a: "recycled"},
            {q: "折り鶴", a: "paper crane"},
            {q: "見てみる", a: "take a look"},
            {q: "私も同じです。", a: "Same here."},
            {q: "記念碑", a: "monument"},
            {q: "犠牲者", a: "victim"},
            {q: "原子（力）の", a: "atomic"},
            {q: "爆弾", a: "bomb"},
            {q: "通り過ぎる、（遠回しに）亡くなる", a: "pass"},
            {q: "消え去って、離れて", a: "away"},
            {q: "（体調が）よくなる", a: "get well"},
            {q: "亡くなる", a: "pass away"},
            {q: "受けとる", a: "receive"},
            {q: "100万（の）", a: "million"},
            {q: "再利用（リサイクル）する", a: "recycle"},
            {q: "伝える、中継する", a: "relay"},
            {q: "折る", a: "fold"},
            {q: "新たにする", a: "renew"},
            {q: "〜を最大限に活用する", a: "make the most of ~"},
            {q: "マスコット", a: "mascot"},
            {q: "着る、身につける", a: "wear"},
            {q: "ブリキ、スズ", a: "tin"},
            {q: "バッジ", a: "badge"},
            {q: "あまりに〜なので…", a: "so ~ that..."},
            {q: "draw(描く)の過去形", a: "drew"},
            {q: "draw(描く)の過去分詞形", a: "drawn"},
            {q: "ストロー", a: "straw"},
            {q: "ワイン、ブドウ酒", a: "wine"},
            {q: "ふだん着の", a: "casual"},
            {q: "おしゃべりをする", a: "chat"},
            {q: "bearの過去分詞形", a: "born"},
            {q: "賞賛する、感心する", a: "admire"},
            {q: "保護", a: "protection"},
            {q: "海洋生物学者", a: "marine biologist"},
            {q: "作家", a: "writer"},
            {q: "write(書く)の過去形", a: "wrote"},
            {q: "危険", a: "danger"},
            {q: "農薬（ふつう複数形で）", a: "agricultural chemical(s)"},
            {q: "環境（保護）の", a: "environmental"},
            {q: "惑星", a: "planet"},
            {q: "開拓者", a: "pioneer"},
            {q: "当時、その頃", a: "in those days"},
            {q: "〜のせいで、〜のおかげで", a: "because of ~"}
        ]
    };

    let currentWordList = databases["Program 8"];
    const stars = JSON.parse(localStorage.getItem('vocab_stars') || '{}');
    let currentIdx = 0;
    let filterMode = 'all'; 
    let activeList = [...currentWordList];

    const programSelect = document.getElementById('program-select');
    const card = document.getElementById('card');
    const qText = document.getElementById('q-text');
    const aText = document.getElementById('a-text');
    const progressBtn = document.getElementById('progress-btn');
    const slider = document.getElementById('progress-slider');
    const sliderPanel = document.getElementById('slider-panel');
    const filterBtn = document.getElementById('filter-btn');
    const starBtn = document.getElementById('star-btn');

    // Handle Program Change
    programSelect.addEventListener('change', (e) => {
        const val = e.target.value;
        if (val === "All") {
            currentWordList = [].concat(databases["Program 6"], databases["Program 7"], databases["Program 8"]);
        } else {
            currentWordList = databases[val];
        }
        currentIdx = 0;
        updateActiveList();
    });

    function updateActiveList() {
        if (filterMode === 'starred') {
            activeList = currentWordList.filter(w => stars[w.a]);
        } else {
            activeList = [...currentWordList];
        }
        
        if (activeList.length === 0) {
            currentIdx = 0;
            qText.textContent = "☆がありません";
            aText.textContent = "お気に入りを追加してください";
            progressBtn.textContent = "0 / 0";
            slider.max = 1;
            starBtn.style.display = "none";
        } else {
            starBtn.style.display = "block";
            if (currentIdx >= activeList.length) currentIdx = 0;
            slider.max = activeList.length;
            updateCard();
        }
    }

    function updateCard(direction = 'none') {
        if (activeList.length === 0) return;

        card.classList.remove('is-flipped');
        const container = document.querySelector('.card-container');
        container.classList.remove('slide-in-right', 'slide-in-left');
        
        if (direction !== 'none') {
            void container.offsetWidth;
            container.classList.add(direction === 'next' ? 'slide-in-right' : 'slide-in-left');
        }

        const current = activeList[currentIdx];
        qText.textContent = current.q;
        aText.textContent = current.a;
        
        // Star Status Initializer
        renderStarState(current.a);

        progressBtn.textContent = `${currentIdx + 1} / ${activeList.length}`;
        slider.value = currentIdx + 1;
    }

    function renderStarState(key) {
        if (stars[key]) {
            starBtn.classList.add('is-starred');
        } else {
            starBtn.classList.remove('is-starred');
        }
    }

    // Card Interaction
    card.addEventListener('click', (e) => {
        if (e.target === starBtn) return;

        if (card.classList.contains('is-flipped')) {
            nextQuestion();
            return;
        }

        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const width = rect.width;

        if (x < width * 0.20) {
            prevQuestion();
        } else if (x > width * 0.80) {
            nextQuestion();
        } else {
            card.classList.add('is-flipped');
        }
        
        sliderPanel.classList.remove('visible');
    });

    // Star Logic
    starBtn.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation(); 
        
        if (activeList.length === 0) return;
        const current = activeList[currentIdx];
        
        if (stars[current.a]) {
            delete stars[current.a];
        } else {
            stars[current.a] = true;
        }
        
        localStorage.setItem('vocab_stars', JSON.stringify(stars));
        renderStarState(current.a);
        
        if (filterMode === 'starred' && !stars[current.a]) {
            setTimeout(updateActiveList, 250);
        }
    });

    function nextQuestion() {
        if (activeList.length === 0) return;
        currentIdx = (currentIdx + 1) % activeList.length;
        updateCard('next');
    }

    function prevQuestion() {
        if (activeList.length === 0) return;
        currentIdx = (currentIdx - 1 + activeList.length) % activeList.length;
        updateCard('prev');
    }

    filterBtn.addEventListener('click', () => {
        filterMode = filterMode === 'all' ? 'starred' : 'all';
        filterBtn.textContent = filterMode === 'all' ? 'すべて' : '☆のみ';
        filterBtn.classList.toggle('active', filterMode === 'starred');
        currentIdx = 0;
        updateActiveList();
    });

    progressBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        sliderPanel.classList.toggle('visible');
    });

    slider.addEventListener('input', (e) => {
        currentIdx = parseInt(e.target.value) - 1;
        updateCard('none');
    });

    document.getElementById('next-btn').addEventListener('click', (e) => { e.stopPropagation(); nextQuestion(); });
    document.getElementById('prev-btn').addEventListener('click', (e) => { e.stopPropagation(); prevQuestion(); });

    // Close panels
    document.addEventListener('click', (e) => {
        if (!sliderPanel.contains(e.target) && e.target !== progressBtn) {
            sliderPanel.classList.remove('visible');
        }
    });

    // Initialize
    updateActiveList();
</script>

</body>
</html>
